<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda de Perfumes - Resultados de Búsqueda</title>
    <link rel="stylesheet" href="css/estilos.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body>
    <div class="main-app-container">
        <header class="main-header">
            <div class="nav-back">
                <button onclick="window.history.back()">
                    <span class="material-symbols-outlined">arrow_back</span>
                </button>
            </div>
            <div class="search-bar">
                <input type="search" placeholder="Buscar">
            </div>
            <nav class="main-nav">
                <a href="catalogo-general.html" class="nav-item">Ver todo</a>
                <a href="catalogo-hombre.html" class="nav-item">Hombre</a>
                <a href="catalogo-mujer.html" class="nav-item">Mujer</a>
                <a href="carrito.html" class="nav-item cart-link">Carrito</a>
            </nav>
        </header>

        <main class="catalogo-content">
            <h2 class="section-title">Resultados para: <span id="query-term" style="color: #f0f0f0;"></span></h2>
            
            <section class="product-grid" id="product-results-grid">
                </section>
        </main>
    </div>
    
    <script src="js/productos.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const productGrid = document.getElementById('product-results-grid');
            const queryTermSpan = document.getElementById('query-term');

            const urlParams = new URLSearchParams(window.location.search);
            const query = urlParams.get('q');
            
            queryTermSpan.textContent = query ? `"${decodeURIComponent(query)}"` : 'Ningún término';

            if (query && productGrid) {
                const searchTerm = query.toLowerCase();

                const resultados = todosLosProductos.filter(producto => 
                    producto.nombre.toLowerCase().includes(searchTerm)
                );

                productGrid.innerHTML = '';

                if (resultados.length > 0) {
                    resultados.forEach(producto => {
                        const productCard = document.createElement('div');
                        productCard.className = 'product-card';
                        productCard.innerHTML = `
                            <img src="${producto.imagen}" alt="${producto.nombre}">
                            <p>${producto.nombre}</p>
                        `;
                        productGrid.appendChild(productCard);
                    });
                } else {
                    productGrid.innerHTML = '<p style="color: white; grid-column: 1 / -1; text-align: center;">No se encontraron productos que coincidan con tu búsqueda.</p>';
                }
            }
        });

        const searchInput = document.querySelector('.search-bar input[type="search"]');
        if (searchInput) {
            searchInput.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    const newQuery = searchInput.value.trim();
                    if (newQuery) {
                        window.location.href = 'resultados-busqueda.html?q=' + encodeURIComponent(newQuery);
                    }
                    e.preventDefault();
                }
            });
        }
    </script>
</body>
</html>